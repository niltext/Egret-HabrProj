var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);n.prototype=t.prototype,e.prototype=new n},__awaiter=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))(function(r,i){function a(e){try{c(o.next(e))}catch(t){i(t)}}function s(e){try{c(o["throw"](e))}catch(t){i(t)}}function c(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(a,s)}c((o=o.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function n(e){return function(t){return o([e,t])}}function o(n){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,i=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break}if(6===n[0]&&c.label<a[1]){c.label=a[1],a=n;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break}a[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(o){n=[6,o],i=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var r,i,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},SingleClass=function(){function e(){}return e.getInstance=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=this;if(!n._instance){var o=e.length;0==o?n._instance=new n:1==o?n._instance=new n(e[0]):2==o?n._instance=new n(e[0],e[1]):3==o&&(n._instance=new n(e[0],e[1],e[2]))}return n._instance},e}();__reflect(SingleClass.prototype,"SingleClass");var ResUtils=function(e){function t(){var t=e.call(this)||this;return t.initVersion(),t.groupMap={},t.configs=new Array,RES.addEventListener(RES.ResourceEvent.GROUP_COMPLETE,t.onResourceLoadComplete,t),RES.addEventListener(RES.ResourceEvent.GROUP_PROGRESS,t.onResourceLoadProgress,t),RES.addEventListener(RES.ResourceEvent.GROUP_LOAD_ERROR,t.onResourceLoadError,t),t}return __extends(t,e),t.prototype.initVersion=function(){},t.prototype.addConfig=function(e,t){this.configs.push([e,t])},t.prototype.loadConfig=function(e,t){this.onConfigComplete=e,this.onConfigCompleteTarget=t,this.loadNextConfig()},t.prototype.loadNextConfig=function(){if(0==this.configs.length)return this.onConfigComplete.call(this.onConfigCompleteTarget),this.onConfigComplete=null,void(this.onConfigCompleteTarget=null);var e=this.configs.shift();RES.addEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigCompleteHandle,this),RES.loadConfig(e[0],e[1])},t.prototype.onConfigCompleteHandle=function(e){RES.removeEventListener(RES.ResourceEvent.CONFIG_COMPLETE,this.onConfigCompleteHandle,this),this.loadNextConfig()},t.prototype.loadGroup=function(e,t,n,o){void 0===t&&(t=null),void 0===n&&(n=null),void 0===o&&(o=null);var r=this.combGroupName(e);null==o||null==n&&null==t||(this.groupMap[r]=[n,t,o]),RES.loadGroup(r)},t.prototype.isGroupLoaded=function(e){return RES.isGroupLoaded(e)},t.prototype.onResourceLoadComplete=function(e){var t=e.groupName;if(console.log("ResUtils >> 加载资源组完成:"+t),this.groupMap[t]){var n=this.groupMap[t][0],o=this.groupMap[t][2];null!=n&&null!=o&&n.call(o),this.groupMap[t]=null,delete this.groupMap[t]}},t.prototype.onResourceLoadProgress=function(e){var t=e.groupName;if(this.groupMap[t]){var n=this.groupMap[t][1],o=this.groupMap[t][2];null!=n&&null!=o&&n.call(o,e)}},t.prototype.onResourceLoadError=function(e){console.error("ResUtils >> 加载资源组错误:"+e.groupName),this.onResourceLoadComplete(e)},t.prototype.combGroupName=function(e){var t="";if("string"==typeof e)t=e;else{for(var n=e.length,o=0;n>o;o++)t+=e[o];RES.createGroup(t,e)}return t},t.prototype.clearAllCallBack=function(){for(var e in this.groupMap)this.groupMap[e]=null,delete this.groupMap[e]},t}(SingleClass);__reflect(ResUtils.prototype,"ResUtils");var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,n,o){function r(e){t.call(o,e)}function i(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,i,null),n.call(o))}var a=this;"undefined"!=typeof generateEUI?egret.callLater(function(){t.call(o,generateEUI)},this):"undefined"!=typeof generateEUI2?RES.getResByUrl("resource/gameEui.json",function(e,n){window.JSONParseClass.setData(e),r(e),egret.callLater(function(){t.call(o,generateEUI2)},a)},this,RES.ResourceItem.TYPE_JSON):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,i,null),RES.getResByUrl(e,r,this,RES.ResourceItem.TYPE_TEXT))},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var BasePanel=function(e){function t(){var t=e.call(this)||this;return t.panelName="",t.percentWidth=100,t.percentHeight=100,t}return __extends(t,e),t.prototype.onEnable=function(e){void 0===e&&(e=null)},t.prototype.onRemove=function(){},t.prototype.playEnterAnim=function(){this.contentGroup&&egret.Tween.get(this.contentGroup).set({scaleX:0,scaleY:0}).to({scaleX:1,scaleY:1},300,egret.Ease.backOut)},t.prototype.onDestory=function(){egret.Tween.removeTweens(this)},t}(eui.Component);__reflect(BasePanel.prototype,"BasePanel");var BaseScene=function(e){function t(){var t=e.call(this)||this;return t.percentWidth=100,t.percentHeight=100,t}return __extends(t,e),t.prototype.onEnable=function(e){void 0===e&&(e=null)},t.prototype.onRemove=function(){},t.prototype.onDestory=function(){this.parent&&this.parent.removeChild(this)},t}(eui.Component);__reflect(BaseScene.prototype,"BaseScene");var BaseUI=function(e){function t(){var t=e.call(this)||this;return t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onEnable,t),t.addEventListener(egret.Event.REMOVED_FROM_STAGE,t.onRemove,t),t}return __extends(t,e),t.prototype.onEnable=function(){},t.prototype.onRemove=function(){},t.prototype.hide=function(){this.parent&&this.parent.removeChild(this)},t.prototype.onDestory=function(){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.onEnable,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this)},t}(eui.Component);__reflect(BaseUI.prototype,"BaseUI");var ScaleButton=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.onTouchBegin=function(t){e.prototype.onTouchBegin.call(this,t),this.initAnchorOffset(),this.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onStageEnd,this),this.scaleX=1.05,this.scaleY=1.05},t.prototype.buttonReleased=function(){e.prototype.buttonReleased.call(this),this.scaleX=1,this.scaleY=1},t.prototype.onTouchCancle=function(t){e.prototype.onTouchCancle.call(this,t),this.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.onStageEnd,this),this.scaleX=1,this.scaleY=1},t.prototype.onStageEnd=function(){this.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.onStageEnd,this),this.scaleX=1,this.scaleY=1},t.prototype.initAnchorOffset=function(){this.anchorOffsetX!=this.width/2&&this.anchorOffsetY!=this.height/2&&(this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2,this.x=this.x+this.width/2,this.y=this.y+this.height/2)},t}(eui.Button);__reflect(ScaleButton.prototype,"ScaleButton");var Main=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var t=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(e){console.log(e)})},t.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return[4,this.loadResource()];case 1:return t.sent(),this.createGameScene(),[4,RES.getResAsync("description_json")];case 2:return e=t.sent(),[2]}})})},t.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return t.trys.push([0,4,,5]),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return t.sent(),[4,this.loadTheme()];case 2:return t.sent(),[4,RES.loadGroup("preload",0)];case 3:return t.sent(),[3,5];case 4:return e=t.sent(),console.error(e),[3,5];case 5:return[2]}})})},t.prototype.loadTheme=function(){var e=this;return new Promise(function(t,n){var o=new eui.Theme("resource/default.thm.json",e.stage);o.addEventListener(eui.UIEvent.COMPLETE,function(){t()},e)})},t.prototype.createGameScene=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return App.getInstance().startUp(this.stage),[2]})})},t}(eui.UILayer);__reflect(Main.prototype,"Main");var ClientSocket=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.reconnenctMax=3,t.curReconnectCount=0,t.allowReconnect=!1,t}return __extends(t,e),t.prototype.connect=function(e,t){void 0===t&&(t=!1),this.resetReconnect(),this.allowReconnect=t,this.createSocket(),this.socket.connectByUrl(e)},t.prototype.createSocket=function(){null==this.socket&&(this.socket=new egret.WebSocket,this.socket.type=egret.WebSocket.TYPE_BINARY,this.socket.addEventListener(egret.Event.CONNECT,this.onConnect,this),this.socket.addEventListener(egret.ProgressEvent.SOCKET_DATA,this.onReceive,this),this.socket.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onError,this),this.socket.addEventListener(egret.Event.CLOSE,this.onClose,this))},t.prototype.onConnect=function(e){this.resetReconnect()},t.prototype.send=function(e,t){var n=new test.user_login;n.userId=123,n.userName="peter";var o=test.user_login.encode(n).finish(),r=new egret.ByteArray(o);this.socket.writeBytes(r),this.socket.flush()},t.prototype.onReceive=function(e){var t=new egret.ByteArray;this.socket.readBytes(t);var n=test.user_login.decode(t.bytes);console.log(n.userId,n.userName)},t.prototype.onError=function(e){0==this.checkReconnenct()},t.prototype.onClose=function(){this.checkReconnenct()?(this.curReconnectCount++,this.socket.connectByUrl(this.serverUrl)):this.resetReconnect()},t.prototype.checkReconnenct=function(){return this.allowReconnect&&this.curReconnectCount<this.reconnenctMax},t.prototype.resetReconnect=function(){this.curReconnectCount=0},t}(SingleClass);__reflect(ClientSocket.prototype,"ClientSocket");var Http=function(e){function t(){var t=e.call(this)||this;return t.request=new egret.HttpRequest,t.request.responseType=egret.HttpResponseType.TEXT,t.request.addEventListener(egret.Event.COMPLETE,t.onSendComplete,t),t.request.addEventListener(egret.IOErrorEvent.IO_ERROR,t.onSendIOError,t),t}return __extends(t,e),t.prototype.doPost=function(e,t,n,o){console.log("Http >> Post请求:",e,t),HttpLock.getInstance().lock(),this.cb=n,this.thisObj=o,this.request.open(e,egret.HttpMethod.POST),this.request.setRequestHeader("Content-type","application/x-www-form-urlencoded"),this.request.send(t)},t.prototype.doGet=function(e,t,n){console.log("Http >> Get请求:",e),HttpLock.getInstance().lock(),this.cb=t,this.thisObj=n,this.request.open(e,egret.HttpMethod.GET),this.request.setRequestHeader("Content-type","application/x-www-form-urlencoded"),this.request.send()},t.prototype.onSendComplete=function(e){if(console.log("Http >> send complete",this.request.response),HttpLock.getInstance().unlock(),this.cb&&this.thisObj){var t=this.cb,n=this.thisObj;this.cb=null,this.thisObj=null,t.call(n,JSON.parse(this.request.response))}},t.prototype.onSendIOError=function(e){console.error("Http >> send error"),HttpLock.getInstance().unlock(),this.cb=null,this.thisObj=null,App.EventManager.sendEvent(EventConst.HTTP_ERROR),App.Tips.showMsg("网络请求失败")},t}(SingleClass);__reflect(Http.prototype,"Http");var DebugPlatform=function(){function e(){}return e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{code:""}]})})},e.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{userInfo:{nickname:"测试用"}}]})})},e.prototype.createRewardedVideoAd=function(){},e.prototype.postMessage=function(e){},e.prototype.setUserCloudStorage=function(e){},e.prototype.shareAppMessage=function(e,t,n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.updateShareMenu=function(){},e.prototype.previewImage=function(e){},e.prototype.toTempFilePath=function(e,t,n,o,r,i){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e.prototype.saveImageToPhotosAlbum=function(e){},e.prototype.getSystemInfo=function(){return{}},e.prototype.setEnableDebug=function(){},e.prototype.openCustomerServiceConversation=function(){},e.prototype.getLaunchOptionsSync=function(){return{}},e.prototype.createGameClubButton=function(e,t,n,o){return{}},e.prototype.showShareCanvas=function(){},e.prototype.webGL=function(e){},e.prototype.hideShareCanvas=function(){},e}();__reflect(DebugPlatform.prototype,"DebugPlatform"),window.platform||(window.platform=new DebugPlatform);var WxPlatform=function(){function e(){}return e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,new Promise(function(e,t){wx.login({success:function(t){console.log("WxPlatform >> login success:",t),e(t)},fail:function(e){},complete:function(e){}})})]})})},e.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,new Promise(function(e,t){wx.getUserInfo({withCredentials:!0,success:function(t){console.log("WxPlatform >> getUserInfo success:",t),e(t)},fail:function(e){},complete:function(e){}})})]})})},e.prototype.createRewardedVideoAd=function(){return new Promise(function(e,t){var n=wx.createRewardedVideoAd({adUnitId:"xxxx"});n.show()["catch"](function(e){n.load().then(function(){return n.show()})}),n.onClose(function(n){n&&n.isEnded||void 0===n?e():t()})})},e.prototype.postMessage=function(e){var t=wx.getOpenDataContext();t.postMessage({data:e})},e.prototype.setUserCloudStorage=function(e){return new Promise(function(t,n){wx.setUserCloudStorage({KVDataList:e,success:function(e){console.log("WxPlatform >> setUserCloudStorage success:",e),t()},fail:function(e){},complete:function(e){}})})},e.prototype.shareAppMessage=function(e,t,n){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(o){return[2,new Promise(function(o,r){wx.shareAppMessage({title:e,imageUrl:t,query:n,success:function(e){console.log("WxPlatform >> shareAppMessage success:",e),o(e)}})})]})})},e.prototype.updateShareMenu=function(){return new Promise(function(e,t){wx.updateShareMenu({withShareTicket:!0,success:function(e){console.log("WxPlatform >> 更新转发属性成功",e)},fail:function(e){},complete:function(e){}})})},e.prototype.previewImage=function(e){return new Promise(function(t,n){wx.previewImage({urls:[e]})})},e.prototype.toTempFilePath=function(e,t,n,o,r,i){return __awaiter(this,void 0,void 0,function(){var r;return __generator(this,function(i){switch(i.label){case 0:return[4,this.getSystemInfo()];case 1:return r=i.sent(),[2,new Promise(function(i,a){var s=r.windowWidth*r.pixelRatio/App.StageUtils.stageWidth,c=r.windowHeight*r.pixelRatio/App.StageUtils.stageHeight;e*=s,t*=c,n*=s,o*=c,canvas.toTempFilePath({x:e,y:t,width:n,height:o,destWidth:n,destHeight:o,success:function(e){console.log("WxPlatform >> toTempFilePath success:",e.tempFilePath),i(e.tempFilePath)},faile:function(e){console.log("WxPlatform >> toTempFilePath fail:")}})})]}})})},e.prototype.saveImageToPhotosAlbum=function(e){return new Promise(function(t,n){wx.saveImageToPhotosAlbum({filePath:e,success:function(e){console.log("WxPlatform >> saveImageToPhotosAlbum success")},fail:function(e){console.log("WxPlatform >> saveImageToPhotosAlbum fail"),App.Tips.showMsg("保存失败，请设置相册权限")},complete:function(e){}})})},e.prototype.getSystemInfo=function(){return new Promise(function(e,t){wx.getSystemInfo({success:function(t){console.log("WxPlatform >> getSystemInfo:",t),e(t)}})})},e.prototype.setEnableDebug=function(){return new Promise(function(e,t){wx.setEnableDebug({enableDebug:!0,success:function(e){},fail:function(e){},complete:function(e){}})})},e.prototype.openCustomerServiceConversation=function(){return new Promise(function(e,t){wx.openCustomerServiceConversation({success:function(e){console.log("WxPlatform >> customerService success:",e)},fail:function(e){console.log("WxPlatform >> customerService fail:",e)},complete:function(e){console.log("WxPlatform >> customerService complete:",e)}})})},e.prototype.getLaunchOptionsSync=function(){return wx.getLaunchOptionsSync()},e.prototype.createGameClubButton=function(e,t,n,o){return wx.createGameClubButton({type:"image",icon:"light",style:{left:e,top:t,width:n,height:o}})},e.prototype.showShareCanvas=function(){console.log("绘制离屏Canvas"),this.bitmapdata=new egret.BitmapData(window.sharedCanvas),this.bitmapdata.$deleteSource=!1;var e=new egret.Texture;e._setBitmapData(this.bitmapdata),this.bitmap=new egret.Bitmap(e),this.bitmap.width=App.StageUtils.stage.stageWidth,this.bitmap.height=App.StageUtils.stage.stageHeight,App.LayerManager.topLayer.addChild(this.bitmap),egret.startTick(this.webGL,this)},e.prototype.webGL=function(e){return egret.WebGLUtils.deleteWebGLTexture(this.bitmapdata.webGLTexture),this.bitmapdata.webGLTexture=null,!1},e.prototype.hideShareCanvas=function(){this.bitmap&&(this.bitmap.parent&&this.bitmap.parent.removeChild(this.bitmap),this.bitmap.$bitmapData.$dispose(),egret.stopTick(this.webGL,this))},e}();__reflect(WxPlatform.prototype,"WxPlatform");var DeviceUtils=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"IsNative",{get:function(){return egret.Capabilities.runtimeType==egret.RuntimeType.NATIVE},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsWeb",{get:function(){return egret.Capabilities.runtimeType==egret.RuntimeType.WEB},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsMobile",{get:function(){return egret.Capabilities.isMobile},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsPC",{get:function(){return!egret.Capabilities.isMobile},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsAndroid",{get:function(){return"Android"==egret.Capabilities.os},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsIos",{get:function(){return"iOS"==egret.Capabilities.os},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsiPad",{get:function(){return navigator.userAgent.indexOf("iPad")>-1?!0:!1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isWx",{get:function(){var e=navigator.userAgent.toLowerCase();return/micromessenger/.test(e)?!0:!1},enumerable:!0,configurable:!0}),t}(SingleClass);__reflect(DeviceUtils.prototype,"DeviceUtils");var EventMananger=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.eventList={},t}return __extends(t,e),t.prototype.sendEvent=function(e,t){void 0===t&&(t=null);var n=this.eventList[e];if(null!=n)for(var o,r,i=n.length,a=0;i>a;a++){var s=n[a];o=s[0],r=s[1],o.call(r,t)}},t.prototype.addEvent=function(e,t,n){var o=this.eventList[e];if(null==o)o=[],this.eventList[e]=o;else for(var r=o.length,i=0;r>i;i++)if(o[i][0]==t&&o[i][1]==n)return;o.push([t,n])},t.prototype.removeEvent=function(e,t,n){var o=this.eventList[e];if(null!=o)for(var r=o.length,i=r-1;i>=0;i--)o[i][0]==t&&o[i][1]==n&&o.splice(i,1);o&&0==o.length&&(this.eventList[e]=null,delete this.eventList[e])},t.prototype.removeAllEvent=function(){for(var e in this.eventList){var t=this.eventList[e];if(null!=t){for(var n=t.length,o=0;n>o;o++)t[o].length=0;t.length=0,this.eventList[e]=null,delete this.eventList[e]}}},t}(SingleClass);__reflect(EventMananger.prototype,"EventMananger");var LayerManager=function(e){function t(){var t=e.call(this)||this,n=App.StageUtils.stage;return t.sceneLayer=new eui.UILayer,t.sceneLayer.percentWidth=100,t.sceneLayer.percentHeight=100,t.sceneLayer.touchEnabled=!1,n.addChild(t.sceneLayer),t.panelLayer=new eui.UILayer,t.panelLayer.percentWidth=100,t.panelLayer.percentHeight=100,t.panelLayer.touchEnabled=!1,n.addChild(t.panelLayer),t.dialogLayer=new eui.UILayer,t.dialogLayer.percentWidth=100,t.dialogLayer.percentHeight=100,t.dialogLayer.touchEnabled=!1,n.addChild(t.dialogLayer),t.lockLayer=new eui.UILayer,t.lockLayer.percentWidth=100,t.lockLayer.percentHeight=100,t.lockLayer.touchEnabled=!1,n.addChild(t.lockLayer),t.tipLayer=new eui.UILayer,t.tipLayer.percentWidth=100,t.tipLayer.percentHeight=100,t.tipLayer.touchEnabled=!1,n.addChild(t.tipLayer),t.topLayer=new eui.UILayer,t.topLayer.percentWidth=100,t.topLayer.percentHeight=100,t.topLayer.touchEnabled=!1,n.addChild(t.topLayer),t}return __extends(t,e),t}(SingleClass);__reflect(LayerManager.prototype,"LayerManager");var NumberTool=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.getRandInt=function(e,t){return e+Math.round(Math.random()*(t-e))},t.formatTime=function(e){return e>=0&&10>e?"0"+e:e+""},t.formatCapital=function(e){return 0>=e||e>=10?"":["一","二","三","四","五","六","七","八","九"][e-1]},t}(SingleClass);__reflect(NumberTool.prototype,"NumberTool");var ObjectPool=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.poolList={},t}return __extends(t,e),t.prototype.getPool=function(e,t){if(void 0===t&&(t=0),!this.poolList[e]&&(this.poolList[e]=new Pool(e),0!=t))for(var n=this.poolList[e],o=0;t>o;o++)n.returnObject(new e);return this.poolList[e]},t}(SingleClass);__reflect(ObjectPool.prototype,"ObjectPool");var Pool=function(){function e(e){this.clz=e,this.list=[]}return e.prototype.getObject=function(){if(this.list.length>0)return this.list.pop();var e=this.clz;return new e},e.prototype.returnObject=function(e){this.list.push(e)},Object.defineProperty(e.prototype,"length",{get:function(){var e=0;for(var t in this.list)e++;return e},enumerable:!0,configurable:!0}),e}();__reflect(Pool.prototype,"Pool");var PanelManager=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.panelMap={},t.groupMap={},t}return __extends(t,e),t.prototype.register=function(e,t){this.panelMap[e]=t},t.prototype.unRegister=function(e){var t=this.panelMap[e];return t&&delete this.panelMap[e],t},t.prototype.open=function(e,t){var n=this;void 0===t&&(t=null);var o=this.panelMap[e];if(null==o&&(o=new e,this.register(e,o)),o){if(null==o.parent){o.once(egret.Event.ADDED_TO_STAGE,function(){o.onEnable(t)},this),o.once(egret.Event.REMOVED_FROM_STAGE,function(){o.onRemove()},this);var r=this.groupMap[e];null!=r&&0==App.ResUtils.isGroupLoaded(r)?(this.showLoadAnim(),App.ResUtils.loadGroup(r,null,function(){n.hideLoadAnim(),App.LayerManager.panelLayer.addChild(o)},this)):App.LayerManager.panelLayer.addChild(o)}else console.log("PanelManager >> 弹框已打开:",e);this.curPanel=o}else console.log("PanelManager >> 弹框不存在:",e);return o},t.prototype.close=function(e){var t=this.panelMap[e];t&&t.parent&&t.parent.removeChild(t)},t.prototype.closeAll=function(){for(var e in this.panelMap)this.close(e)},t.prototype.destoryPanel=function(e){var t=this.panelMap[e];t&&(this.close(e),delete this.panelMap[e],delete this.groupMap[e],t==this.curPanel&&(this.curPanel=null),t.onDestory(),console.log("销毁panel",e))},t.prototype.destoryAllPanel=function(){for(var e in this.panelMap)this.destoryPanel(e)},t.prototype.showLoadAnim=function(){this.loadAnim&&App.LayerManager.lockLayer.addChild(this.loadAnim)},t.prototype.hideLoadAnim=function(){this.loadAnim&&this.loadAnim.parent&&this.loadAnim.parent.removeChild(this.loadAnim)},t}(SingleClass);__reflect(PanelManager.prototype,"PanelManager");var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,n){function o(o){t.call(n,o,e)}if(RES.hasRes(e)){var r=RES.getRes(e);r?o(r):RES.getResAsync(e,o,this)}else RES.getResByUrl(e,o,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var SceneManager=function(e){function t(){var t=e.call(this)||this;return t.sceneMap={},t}return __extends(t,e),t.prototype.register=function(e,t){return null!=this.sceneMap[e]?void console.log("SceneManager >> 场景已存在:",e):void(this.sceneMap[e]=t)},t.prototype.unRegister=function(e){var t=this.sceneMap[e];return null!=t&&delete this.sceneMap[e],t},t.prototype.open=function(e,t){void 0===t&&(t=null);var n=this.sceneMap[e];if(null==n&&(n=new e,this.register(e,n)),n)if(null==n.parent){var o=this.curScene;this.curScene=n,o&&o.parent&&o.parent.removeChild(o),n.once(egret.Event.ADDED_TO_STAGE,function(){n.onEnable(t)},this),n.once(egret.Event.REMOVED_FROM_STAGE,function(){n.onRemove()},this),App.LayerManager.sceneLayer.addChild(n)}else console.error("SceneManager >> 场景重复打开:",e);else console.error("SceneManager >> 场景不存在:",e);return n},t.prototype.getScene=function(e){return this.sceneMap[e]},t.prototype.getCurScene=function(){return this.curScene},t.prototype.destoryScene=function(e){var t=this.sceneMap[e];t&&(t.parent&&t.parent.removeChild(t),t.onDestory(),delete this.sceneMap[e],t==this.curScene&&(this.curScene=null))},t.prototype.destoryAllScene=function(){for(var e in this.sceneMap)this.destoryScene(e);this.curScene=null},t}(SingleClass);__reflect(SceneManager.prototype,"SceneManager");var SoundManager=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.allowEffect=!0,t.allowBGM=!0,t.soundList={},t}return __extends(t,e),t.prototype.playEffect=function(e,t){var n=this;if(void 0===t&&(t=1),0!=this.allowEffect){var o=this.soundList[e];if(o)o.type=egret.Sound.EFFECT,o.play(0,t);else if(o=RES.getRes(e))this.soundList[e]=o,o.type=egret.Sound.EFFECT,o.play(0,t);else{var r="resource/assets/music/"+e.replace("_mp3",".mp3");RES.getResByUrl(r,function(o){n.soundList[e]=o,o.type=egret.Sound.EFFECT,o.play(0,t)},this,RES.ResourceItem.TYPE_SOUND)}}},t.prototype.playBGM=function(e){var t=this;if(0!=this.allowBGM){var n=this.soundList[e];if(n)n.type=egret.Sound.MUSIC,null==this.bgmChannel&&(this.bgmChannel=n.play(0,Number.MAX_VALUE));else if(n=RES.getRes(e))this.soundList[e]=n,n.type=egret.Sound.MUSIC,null==this.bgmChannel&&(this.bgmChannel=n.play(0,Number.MAX_VALUE));else{var o="resource/assets/music/"+e.replace("_mp3",".mp3");RES.getResByUrl(o,function(n){t.soundList[e]=n,n.type=egret.Sound.MUSIC,null==t.bgmChannel&&(t.bgmChannel=n.play(0,Number.MAX_VALUE))},this,RES.ResourceItem.TYPE_SOUND)}}},t.prototype.stopBGM=function(){this.bgmChannel&&(this.bgmChannel.stop(),this.bgmChannel=null)},t}(SingleClass);__reflect(SoundManager.prototype,"SoundManager");var StageUtils=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"stageWidth",{get:function(){return this.stage.stageWidth},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stageHeight",{get:function(){return this.stage.stageHeight},enumerable:!0,configurable:!0}),t.prototype.changeBgColor=function(e){document.body.style.backgroundColor=e},t.prototype.someScreenShowAll=function(){var e=egret.Capabilities.boundingClientWidth/egret.Capabilities.boundingClientHeight;(1520/1080>e||e>1920/1080)&&(this.stage.scaleMode=egret.StageScaleMode.SHOW_ALL)},t}(SingleClass);__reflect(StageUtils.prototype,"StageUtils");var App=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.getInstance=function(){return null==this.appInstance&&(this.appInstance=new t),this.appInstance},t.prototype.startUp=function(e){this.registerCommand(CMDConst.START_UP,StartupCommand),this.sendNotification(CMDConst.START_UP,e),this.removeCommand(CMDConst.START_UP)},Object.defineProperty(t,"ResUtils",{get:function(){return ResUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"StageUtils",{get:function(){return StageUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"PanelManager",{get:function(){return PanelManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"SceneManager",{get:function(){return SceneManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"LayerManager",{get:function(){return LayerManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"SoundManager",{get:function(){return SoundManager.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DeviceUtils",{get:function(){return DeviceUtils.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"EventManager",{get:function(){return EventMananger.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"DataCenter",{get:function(){return DataCenter.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Http",{get:function(){return Http.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"ObjectPool",{get:function(){return ObjectPool.getInstance()},enumerable:!0,configurable:!0}),Object.defineProperty(t,"Tips",{get:function(){return Tips.getInstance()},enumerable:!0,configurable:!0}),t}(puremvc.Facade);__reflect(App.prototype,"App");var StartupCommand=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.execute=function(e){console.log("StartupCommand >> 初始化启动"),App.StageUtils.stage=e.getBody(),platform.updateShareMenu(),console.log("StartupCommand >> 初始化完毕")},t}(puremvc.SimpleCommand);__reflect(StartupCommand.prototype,"StartupCommand");var AssetConst=function(){function e(){}return e.Preload="preload",e.Login="login",e.Hall="hall",e.Sound="sound",e}();__reflect(AssetConst.prototype,"AssetConst");var CMDConst=function(){function e(){}return e.START_UP="START_UP",e}();__reflect(CMDConst.prototype,"CMDConst");var EventConst=function(){function e(){}return e.HTTP_ERROR="HTTP_ERROR",e.CONTINUE_GAME="CONTINUE_GAME",e.AGAIN_GAME="AGAIN_GAME",e.UPDATE_HEART="UPDATE_HEART",e.SHOW_GAME_CLUB="SHOW_GAME_CLUB",e}();__reflect(EventConst.prototype,"EventConst");var GameConst=function(){function e(){}return e.getOver=function(e){return e>=0&&5>=e?NumberTool.getRandInt(5,10):e>5&&30>=e?NumberTool.getRandInt(10,20):e>30&&50>=e?NumberTool.getRandInt(20,30):e>50&&70>=e?NumberTool.getRandInt(30,50):e>70&&100>=e?NumberTool.getRandInt(50,80):e>100&&200>=e?NumberTool.getRandInt(80,90):e>200?NumberTool.getRandInt(90,98):void 0},e.getLevel=function(e){var t=Math.ceil(e/50);return t=14>=t?t:14},e.getScoreTitle=function(t){var n=e.getLevel(t);return e.levelName[n-1]},e.heart=10,e.bUseHeart=!1,e.bLookVideo=!1,e.freeHeart=0,e.mapSpeed=10,e.roadX=[96,268,456,624],e.roadY=840,e.score=0,e.worldRank=0,e.worldMaxScore=0,e.levelName=["头盔哥","隔壁老王","单身汪","绿帽哥","夜猫君","全村的希望","包治百病","天生萌货","国民女流氓","限量版逗比","超级小正太","富家子弟","奔跑吧奶奶","小猪佩奇"],e.hotGameList=[{type:"game",icon:"hot_game0_png",name:"飞机大战",des:"打遍天下无敌手，只要一个机会",gameUrl:""},{type:"game",icon:"hot_game1_png",name:"弹球球",des:"弹跳吧！球球",gameUrl:""},{type:"game",icon:"hot_game2_png",name:"极限赛车",des:"听闻你是传说中的赛车奇才",gameUrl:"http://m.qpic.cn/psb?/V12nBJhN4BTISo/fAMMUexv8DtWvi7FADe8Yt*GkVxqgIFVWx2mRaxiWZE!/b/dFkAAAAAAAAA&bo=gANABgAAAAARF.U!&rf=viewer_4&t=5"},{type:"game",icon:"hot_game2_png",name:"赛车神手",des:"赛车神手，你就是那个第一",gameUrl:""},{type:"more",moreImg0:"hot_game3_png",moreImg1:"hot_game3_png",moreImg2:"hot_game3_png",gameUrl:""}],e.iOS=!1,e}();__reflect(GameConst.prototype,"GameConst");var SoundConst=function(){function e(){}return e.BGM="bgm_mp3",e
}();__reflect(SoundConst.prototype,"SoundConst");var DataCenter=function(e){function t(){var t=e.call(this)||this;return t.loginInfo=new LoginInfo,t.userInfo=new UserInfo,t}return __extends(t,e),t}(SingleClass);__reflect(DataCenter.prototype,"DataCenter");var LoginInfo=function(){function e(){}return e}();__reflect(LoginInfo.prototype,"LoginInfo");var UserInfo=function(){function e(){}return e.prototype.saveData=function(e){this.nickName=e.nickName,this.avatarUrl=e.avatarUrl,this.signature=e.signature},e}();__reflect(UserInfo.prototype,"UserInfo");var ProtoData=function(){function e(){}return e}();__reflect(ProtoData.prototype,"ProtoData");var ProtoUrl=function(){function e(){}return e.WX_LOGIN="https://www.zhijianmohe.cn/rxwl/wechat/wxapi/6/wxlogin",e.DECODE_USER="https://www.zhijianmohe.cn/rxwl/wechat/wxapi/6/decodewxuser",e.USER_INFO="https://www.zhijianmohe.cn/rxwl/wechat/game/6/user_info",e.INVITE_INFO="https://www.zhijianmohe.cn/rxwl/wechat/invite/6/inviteinfo",e.GET_INVITE_REWARD="https://www.zhijianmohe.cn/rxwl/wechat/invite/6/getinviteward",e.GET_MAX_SCORE="https://www.zhijianmohe.cn/rxwl/wechat/score/6/get_max_score",e.ADD_MAX_SCORE="https://www.zhijianmohe.cn/rxwl/wechat/score/6/add_max_score",e.WORLD_RANK_LIST="https://www.zhijianmohe.cn/rxwl/wechat/score/6/ranking_list",e.PROPS_BAG="https://www.zhijianmohe.cn/rxwl/wechat/game/6/props_bag",e.CONSUME_PROPS="https://www.zhijianmohe.cn/rxwl/wechat/game/6/consume_props",e.ADD_PROPS="https://www.zhijianmohe.cn/rxwl/wechat/game/6/add_props",e.MORE_GAME="https://www.zhijianmohe.cn/rxwl/wechat/game/6/more_game",e}();__reflect(ProtoUrl.prototype,"ProtoUrl");var HttpLock=function(e){function t(){var t=e.call(this)||this;return t.skinName="HttpLockSkin",t.percentWidth=100,t.percentHeight=100,t}return __extends(t,e),t.prototype.lock=function(){var e=this;this.labelGroup.visible=!1,App.LayerManager.lockLayer.addChild(this),egret.Tween.removeTweens(this),egret.Tween.get(this).wait(2e3).call(function(){e.labelGroup.visible=!0},this)},t.prototype.unlock=function(){this.labelGroup.visible=!1,egret.Tween.removeTweens(this),this.parent&&this.parent.removeChild(this)},t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t}(eui.Component);__reflect(HttpLock.prototype,"HttpLock");var Tips=function(e){function t(){var t=e.call(this)||this;return t.skinName="TipsSkin",t}return __extends(t,e),t.prototype.childrenCreated=function(){this.horizontalCenter=0,this.verticalCenter=0},t.prototype.showMsg=function(e){var t=this;this.msgLabel.text=e,App.LayerManager.tipLayer.addChild(this),egret.Tween.removeTweens(this),egret.Tween.get(this).wait(1500).call(function(){t.parent&&t.parent.removeChild(t)},this)},t.getInstance=function(){return null==this.instance&&(this.instance=new t),this.instance},t}(eui.Component);__reflect(Tips.prototype,"Tips");